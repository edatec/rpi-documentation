== GPIO 和 40-pin

Raspberry Pi 的一个强大功能是沿电路板顶部边缘的一排 GPIO（通用输入/输出）引脚。在所有当前的Raspberry Pi板上都可以找到一个40针GPIO接头（在Raspberry Pi Zero，Raspberry Pi Zero W和Raspberry Pi Zero 2 W上未填充）。在Raspberry Pi 1 Model B+（2014）之前，电路板由一个较短的26引脚接头组成。所有电路板（包括Raspberry Pi 400）上的GPIO接头具有0.1英寸（2.54毫米）的引脚间距。

image::images/GPIO-Pinout-Diagram-2.png[GPIO pins]

任何GPIO引脚都可以指定（在软件中）为输入或输出引脚，并用于广泛的用途。

image::images/GPIO.png[GPIO layout]

NOTE: GPIO 引脚的编号不按数字顺序排列;板上存在 GPIO 引脚 0 和 1（物理引脚 27 和 28），但保留用于高级用途（见下文）。

=== 电压

电路板上有两个5V引脚和两个3.3V引脚，以及许多接地引脚（0V），这些引脚是不可配置的。其余引脚均为通用3.3V引脚，这意味着输出设置为3.3V，输入可承受3.3V。

=== 输出

指定为输出引脚的 GPIO 引脚可以设置为高 （3.3V） 或低 （0V）。

=== 输入

指定为输入引脚的GPIO引脚可以读取为高电平（3.3V）或低电平（0V）。使用内部上拉或下拉电阻器可以更轻松地做到这一点。引脚 GPIO2 和 GPIO3 具有固定的上拉电阻，但对于其他引脚，可以在软件中进行配置。

=== 更多

除了简单的输入和输出设备外，GPIO 引脚还可以与各种替代功能一起使用，有些可用于所有引脚，有些可用于特定引脚。

* PWM (脉宽调制)
 ** 所有引脚均提供软件 PWM
 ** 硬件 PWM 在 GPIO12、GPIO13、GPIO18、GPIO19 上可用
* SPI
 ** SPI0： MOSI （GPIO10）;MISO（GPIO9）;SCLK （GPIO11）;CE0 （GPIO8）， CE1 （GPIO7）
 ** SPI1： MOSI （GPIO20）;MISO GPIO19）;SCLK （GPIO21）;CE0 （GPIO18）;CE1 （GPIO17）;CE2 （GPIO16）
* I2C
 ** Data: (GPIO2); Clock (GPIO3)
 ** EEPROM Data: (GPIO0); EEPROM Clock (GPIO1)
* Serial
 ** TX (GPIO14); RX (GPIO15)

=== GPIO 引脚排列

可以通过打开终端窗口并运行pinout命令来访问树莓派上的便捷参考。此工具由https://gpiozero.readthedocs.io/[GPIO Zero]  Python库提供，该库默认安装在Raspberry Pi OS中。 

image::images/gpiozero-pinout.png[]

有关 GPIO 引脚的高级功能的更多详细信息，请参阅 gadgetoid 的 http://pinout.xyz/[交互式引脚排列图]。

WARNING: 虽然将简单组件连接到 GPIO 引脚是完全安全的，但请务必小心连接方式。LED应具有电阻器以限制通过它们的电流。不要将 5V 用于 3.3V 组件。不要将电机直接连接到 GPIO 引脚，而应使用 https://projects.raspberrypi.org/en/projects/physical-computing/14[H 桥电路或电机控制器板]。

=== 权限

要使用 GPIO 端口，您的 `gpio` 用户必须是该组的成员。 `pi` 用户默认为成员，其他用户需要手动添加

[,bash]
----
sudo usermod -a -G gpio <username>
----

=== Python 中的 GPIO

Python 中的 GPIO https://gpiozero.readthedocs.io/[GPIO Zero] 库可以轻松开始使用 Python 控制 GPIO 设备. 该库在 https://gpiozero.readthedocs.io/[gpiozero.readthedocs.io] 有全面的记录。

==== LED

要控制连接到 GPIO17 的 LED，可以使用以下代码：

[,python]
----
from gpiozero import LED
from time import sleep

led = LED(17)

while True:
    led.on()
    sleep(1)
    led.off()
    sleep(1)
----

在像Thonny这样的IDE中运行它，LED将反复闪烁。
LED 方法包括  `on()`, `off()`, `toggle()`, 和 `blink()`。

==== 按钮

若要读取连接到 GPIO2 的按钮的状态，可以使用以下代码：

[,python]
----
from gpiozero import Button
from time import sleep

button = Button(2)

while True:
    if button.is_pressed:
        print("Pressed")
    else:
        print("Released")
    sleep(1)
----

Button functionality includes the properties `is_pressed` and `is_held`; callbacks `when_pressed`, `when_released`, and `when_held`; and methods `wait_for_press()` and `wait_for_release`.

按钮功能包括属性 `is_pressed` 和 `is_held` ;回调`when_pressed` 、`when_released` 和 `when_held` ;和方法 `wait_for_press()` 和 `wait_for_release`。

==== 按钮 + 指示灯

要将 LED 和按钮连接在一起，您可以使用以下代码：

[,python]
----
from gpiozero import LED, Button

led = LED(17)
button = Button(2)

while True:
    if button.is_pressed:
        led.on()
    else:
        led.off()
----

或者：

[,python]
----
from gpiozero import LED, Button

led = LED(17)
button = Button(2)

while True:
    button.wait_for_press()
    led.on()
    button.wait_for_release()
    led.off()
----

或者：

[,python]
----
from gpiozero import LED, Button

led = LED(17)
button = Button(2)

button.when_pressed = led.on
button.when_released = led.off
----

